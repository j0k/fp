

* what we hook

| hook        | dont hook  | args                                                                       | ? check   |
|-------------+------------+----------------------------------------------------------------------------+-----------|
| open        |            | int open(const char *pathname, int flags, mode_t mode)                     |           |
| rmdir       |            | int rmdir(const char *pathname)                                            |           |
| unlink      |            | int unlink(const char *pathname)                                           |           |
| unlinkat    |            | int unlinkat(int dirfd, const char *pathname, int flags)                   |           |
|             | fdopendir  | DIR *fdopendir(int fd)                                                     |           |
| opendir     |            | DIR *opendir(const char *name)                                             |           |
| readdir   = |            | struct dirent *readdir(DIR *dirp)                                          | ltrace ls |
| readdir64 = |            | struct dirent64 *readdir64(DIR *dirp)                                      |           |
|             |            |                                                                            |           |
|             |            |                                                                            |           |
| stat        |            | int stat(const char *path, struct stat *buf)                               |           |
|             | fstat      | int fstat(int fd, struct stat *buf)                                        |           |
|             | fstat64    | int fstat64(int fd, struct stat64 *buf)                                    |           |
|             | __fxstat   | int __fxstat(int ver, int fildes, struct stat *buf)                        |           |
|             | __fxstat64 | int __fxstat64(int ver, int fildes, struct stat64 *buf)                    |           |
|             |            |                                                                            |           |
| lstat       |            | int lstat(const char *file, struct stat *buf)                              |           |
| lstat64     |            | int lstat64(const char *file, struct stat64 *buf)                          |           |
|             |            |                                                                            |           |
| __lxstat    |            | int __lxstat(int ver, const char *file, struct stat *buf)                  |           |
| __lxstat64  |            | int __lxstat64(int ver, const char *file, struct stat64 *buf)              |           |
|             |            |                                                                            |           |
| stat64      |            | int stat64(const char *path, struct stat64 *buf)                           |           |
| __xstat     |            | int __xstat(int ver, const char *path, struct stat *buf)                   |           |
| __xstat64   |            | int __xstat64(int ver, const char *path, struct stat64 *buf)               |           |
|             |            |                                                                            |           |
| execve      |            | int execve(const char *filename, char *const argv[],  char *const envp[]); |           |
| execl       |            |                                                                            |           |
| fexecve     |            |                                                                            |           |
|             |            |                                                                            |           |
|             |            |                                                                            |           |
|             |            |                                                                            |           |

...
       int execl(const char *path, const char *arg, ...);
       int execlp(const char *file, const char *arg, ...);
       int execle(const char *path, const char *arg,
                  ..., char * const envp[]);
       int execv(const char *path, char *const argv[]);
       int execvp(const char *file, char *const argv[]);
       int execvpe(const char *file, char *const argv[],
                   char *const envp[]);
